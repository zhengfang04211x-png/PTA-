# PTA策略回测系统 - 运行指南

## 📋 前置要求

### 1. 安装Python
确保已安装Python 3.7或更高版本

### 2. 安装依赖包

在项目目录下打开终端（PowerShell或CMD），运行：

```bash
pip install -r requirements.txt
```

或者单独安装：

```bash
pip install streamlit pandas numpy matplotlib seaborn plotly fonttools tqdm
```

## 🚀 运行方式

### 方法1：使用Streamlit命令（推荐）

1. **打开终端/命令行**
   - Windows: 按 `Win + R`，输入 `cmd` 或 `powershell`
   - 或者在项目文件夹中，按住 `Shift` 键，右键点击空白处，选择"在此处打开PowerShell窗口"

2. **切换到项目目录**
   ```bash
   cd "c:\Users\小方\Desktop\PTA\pta_strategy_github"
   ```

3. **运行应用**
   ```bash
   streamlit run app.py
   ```

4. **访问应用**
   - 浏览器会自动打开，显示地址：`http://localhost:8501`
   - 如果没有自动打开，手动在浏览器输入：`http://localhost:8501`

### 方法2：使用Python直接运行

```bash
python -m streamlit run app.py
```

### 方法3：指定端口运行

如果8501端口被占用，可以指定其他端口：

```bash
streamlit run app.py --server.port 8502
```

然后访问：`http://localhost:8502`

## 📊 使用说明

### 1. 上传数据文件
- 在网页界面中，点击"上传数据文件"
- 上传包含PTA期货价格和PX价差数据的CSV文件

### 2. 设置回测参数
- 调整策略参数（如阈值、持仓周期等）
- 点击"开始回测"按钮

### 3. 查看结果
- 查看回测报告
- 查看可视化图表
- 分析策略表现

## ⚠️ 常见问题

### 问题1：端口被占用
**解决方案**：
```bash
# 使用其他端口
streamlit run app.py --server.port 8502
```

### 问题2：模块未找到错误
**解决方案**：
```bash
# 重新安装依赖
pip install -r requirements.txt
```

### 问题3：中文字体显示问题
应用会自动处理中文字体，如果仍有问题，确保系统已安装中文字体。

### 问题4：浏览器未自动打开
手动在浏览器输入：`http://localhost:8501`

## 🛑 停止服务

在运行Streamlit的终端窗口中，按 `Ctrl + C` 停止服务。

## 📝 快速启动脚本

可以创建一个批处理文件 `启动.bat`：

```batch
@echo off
cd /d "%~dp0"
streamlit run app.py
pause
```

双击 `启动.bat` 即可运行。

## 🔧 高级配置

### 自定义配置
创建 `.streamlit/config.toml` 文件可以自定义配置：

```toml
[server]
port = 8501
headless = false

[browser]
gatherUsageStats = false
```

## 📞 技术支持

如遇到问题，请检查：
1. Python版本是否符合要求
2. 所有依赖包是否已正确安装
3. 数据文件格式是否正确
4. 端口是否被其他程序占用
